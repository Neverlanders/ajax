<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
          name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <title>Document</title>
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet">
</head>
<body>
<h1>HARRY POTTER CHARACTERS</h1>

<ul id="categories" class="nav nav-pills mb-3" id="pills-tab" role="tablist">

</ul>
<div class="tabinhoud" id="pills-tabContent">
    <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">...</div>
    <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">...</div>
    <div class="tab-pane fade" id="pills-contact" role="tabpanel" aria-labelledby="pills-contact-tab">...</div>
</div>


<script crossorigin="anonymous"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    function jsonLink() {
        const xhr = new XMLHttpRequest();
        xhr.onload = onLoad;//methode die uiteindelijk het externe bestand zal laden.
        xhr.open("GET", "http://hp-api.herokuapp.com/api/characters", true);
        xhr.send(null); //null wordt verstuurd bij de request, omdat de status van de
        //server en het json bestand in dit gedeelte van de programmatie hier NOG NIET GEKEND is.

        function onLoad() {
            const categories= document.getElementById("categories");
            const tabinhoud = document.getElementById("tabinhoud");

            let naam = JSON.parse(this.responseText);
            let count = JSON.parse(this.responseText).length;
            let allHouses = [];
            let uniqueHouses = [];
            //for loop om alle huizen op te halen.
            for (i = 0; i < count; i++) {
                if(naam[i]["house"] !=="") {
                    //de array van ALLE huizen van IEDER character worden hier gevuld.
                    allHouses.push(naam[i]["house"]);
                }
            }
            // We nemen allhouses en filteren de unieke waarden er uit in de variabele uniqueHouses.
            uniqueHouses = [...new Set(allHouses)];
            console.log(uniqueHouses.toString());

            //Nu lussen we de unieke array met houses en
            let vullenData = "";
            for (i = 0; i < uniqueHouses.length; i++) {
                if(i==0){
                    vullenData += `<li class="nav-item" role="presentation">
                    <button class="nav-link active" id="pills-${uniqueHouses[i]}-tab" data-bs-toggle="pill" data-bs-target="#pills-${uniqueHouses[i]}" type="button" role="tab" aria-controls="pills-${uniqueHouses[i]}" aria-selected="true">${uniqueHouses[i]}</button>
                    </li>`;
                }else{
                    vullenData += `<li class="nav-item" role="presentation">
                    <button class="nav-link" id="pills-${uniqueHouses[i]}-tab" data-bs-toggle="pill" data-bs-target="#pills-${uniqueHouses[i]}" type="button" role="tab" aria-controls="pills-${uniqueHouses[i]}" aria-selected="false">${uniqueHouses[i]}</button>
                    </li>`;
                }
            }
            document.getElementById("categories").innerHTML = vullenData;

            //Nu vullen we het tab content gedeelte (NOG IN OPMAAK KOMT ERAAN)

            let vullenTabContent = "";
            for (i = 0; i < uniqueHouses.length; i++) {
                if(i==0){
                    vullenTabContent += `<div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">...</div>`;
                }else{
                    vullenTabContent += `<div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">...</div>`;
                }
            }
            }

    }

    window.addEventListener("load", jsonLink);
</script>
</body>
</html>